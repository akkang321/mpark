<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zenith.admin.user.dao.AdminUserDao"> 

	<select id="userList" resultType="hashmap" parameterType="hashmap"> 
		<include refid="common.stratPage" />
		SELECT 		U_ID		,USER_NAME			,PHONE		,EMAIL		,USER_STATE 
					,FN_CODE_NAME(GENDER) AS FN_GENDER			,FN_CODE_NAME(USER_STATE) AS FN_USER_STATE	 
					,DATE_FORMAT(CREATE_DATE, '%Y-%m-%d %H:%i:%s') AS CREATE_DATE 
					,DATE_FORMAT(UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS UPDATE_DATE 
		FROM 		USER_INFO 
		WHERE 		USER_TYPE = 'C010200' 
		<if test='sUserState!=null and sUserState!=""'> 
			AND USER_STATE = #{sUserState}
		</if>
		<if test='sUId!=null and sUId != ""'> 
			AND U_ID LIKE CONCAT('%', #{sUId}, '%')
		</if>
		<if test='sUserName!=null and sUserName!=""'> 
			AND USER_NAME LIKE CONCAT('%', #{sUserName}, '%')
		</if>
		<if test='sPhone!=null and sPhone!=""'> 
			AND PHONE LIKE CONCAT('%', #{sPhone}, '%')
		</if>
		<include refid="common.endPage"/> 
	</select>
	
	<select id="userCnt" parameterType="hashmap" resultType="int"> 
		SELECT	COUNT(1) AS CNT 
		FROM 	USER_INFO 
		WHERE 	USER_TYPE = 'C010200' 
		<if test='sUserState!=null and sUserState!=""'> 
			AND USER_STATE = #{sUserState} 
		</if>
		<if test='sUId!=null and sUId!=""'>
			AND U_ID LIKE CONCAT('%', #{sUId}, '%')
		</if>
		<if test='sUserName!=null and sUserName!=""'>
			AND USER_NAME LIKE CONCAT('%', #{sUserName}, '%')
		</if>
		<if test='sPhone!=null and sPhone!=""'>
			AND PHONE LIKE CONCAT('%', #{sPhone}, '%')
		</if>
	</select>
	
	<select id="userInfo" parameterType="String" resultType="hashmap">
		SELECT		U_ID		,USER_NAME		,PHONE		,EMAIL		,FN_CODE_NAME(GENDER) AS GENDER		,USER_STATE 
		FROM 		USER_INFO
		WHERE 		U_ID = #{ uId } 
	</select>
	
	<update id="userUpdate" parameterType="hashmap"> 
		UPDATE 		USER_INFO
		SET 		USER_NAME=#{userName}	,PHONE=#{phone}		,EMAIL=#{mail} 
					,GENDER=#{gender}		,USER_STATE=#{userState} 
		WHERE 		U_ID=#{uId}
	</update>
	
	<update id="userPwInit" parameterType="hashmap">
		UPDATE 		USER_INFO
		SET			USER_PW = #{pwInit}
		WHERE		U_ID = #{uId};
	</update>
	
	<delete id="userDelete" parameterType="hashmap">
		DELETE		FROM USER_INFO 
		WHERE		U_ID = #{uId}
	</delete>

</mapper>

