<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zenith.admin.academy.dao.AdminAcademyCouponDao"> 

	<select id="academyCouponList" parameterType="hashmap" resultType="hashmap"> 
	<include refid="common.stratPage" /> 	
		SELECT 		COUPON_ID			,COUPON_NAME		,COUPON_TYPE		,COUPON_DISCOUNT 
					,USE_YN				,DATE_FORMAT(EXPIRY_DATE,'%Y-%m-%d') AS EXPIRY_DATE		,FN_CODE_NAME(COUPON_TYPE)		AS CODE_NAME 
		
		FROM 		COUPON_INFO
	<include refid="common.endPage"/> 
	</select>
	
	<select id="academyCouponInfo" parameterType="hashmap" resultType="hashmap"> 
		SELECT 		COUPON_ID			,COUPON_NAME		,COUPON_TYPE		,COUPON_DISCOUNT		,USE_YN 
					,FN_CODE_NAME(USE_YN)	AS		CODE_NAME					,EXPIRY_DATE 
		FROM 		COUPON_INFO 
		
		WHERE 		COUPON_ID = #{couponId}
	</select>
	
	<select id="couponIdCheck" parameterType="hashmap" resultType="int"> 
		SELECT 		COUNT(1)
		FROM 		COUPON_INFO
		
		WHERE 		COUPON_ID = #{couponId}
	</select>
	
	<insert id="academyCouponInsert" parameterType="hashmap"> 
		INSERT INTO COUPON_INFO(
								COUPON_ID			,COUPON_NAME		,COUPON_TYPE		,COUPON_DISCOUNT 
								,USE_YN				,EXPIRY_DATE 		,CREATE_ID			,CREATE_DATE
								)
		
		VALUES (
				#{couponId}		,#{couponName}		,#{couponType}		,#{couponDiscount} 
				,#{useYn}		,#{expiryDate}		,#{uId}				,NOW()
				)
	</insert>
	
	<update id="academyCouponUpdate" parameterType="hashmap"> 
		UPDATE		COUPON_INFO
		SET 		COUPON_NAME=#{couponName}			,COUPON_TYPE=#{couponType}		,COUPON_DISCOUNT=#{couponDiscount} 
					,USE_YN=#{useYn}					,EXPIRY_DATE=#{expiryDate}		,UPDATE_ID=#{uId}					,UPDATE_DATE=NOW() 

		WHERE		COUPON_ID=#{couponId}
	</update>
	
	<delete id="academyCouponDelete" parameterType="hashmap"> 
		DELETE 		FROM 	COUPON_INFO

		WHERE 		COUPON_ID = #{couponId} 
	</delete>
	
	<select id="couponCnt" parameterType="hashmap" resultType="int"> 
		SELECT COUNT(1) FROM COUPON_INFO 
	</select>
	
</mapper>


